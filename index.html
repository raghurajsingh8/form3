<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
   <link rel="stylesheet" href="style.css">
   <link rel="icon" sizes="1512x1512" href="https://newpious.com/wp-content/uploads/2023/04/logo_211__1_-removebg-preview-1.png" type="image/x-icon">
  <title>Newpious Synergies</title>
</head>
<body>
  
  <h1 class="first-heading">Newpious Synergies</h1>
<form id="dynamicForm" name="goggle-sheet" action="https://script.google.com/macros/s/AKfycbw-9-BCYLaM3-C4phvezylMtuvsRQmuVtDLMN8_yWJA4pgMwIl6TAwFlVXjosjvH_Smqw/exec " method="post">  <!-- First question -->
    <label for="systemType">Type of System:</label>
    <h2 id="selectedSystemType">Refresh Page for selection </h2> <!-- Element to display selected option -->
    
    <!-- <option value="">Select</option>
    <option value="on_grid">ON GRID</option>
    <option value="off_grid">OFF GRID</option>
    <option value="hybrid">Hybrid</option>
    <option value="flour_mill">Flour Mill Atta Chakki</option>
    <option value="solar_pump">Solar Pump</option>
    <option value="existing_plant">Existing Plant</option> -->
  </select>

  <!-- General Questions (common for all) -->
  <div id="generalQuestions">
    <h3>PROJECT DESIGN INPUTS</h3>
    <label for="capacity">Plant Expected Capacity:</label>
    <input type="text" id="capacity" name="capacity"  required><br>

    <label for="siteAddress">Site Address:</label>
    <input type="text" id="siteAddress" name="siteAddress"  required><br>

    <label for="googleCoordinates">Google Coordinates:</label>
    <input type="text" id="googleCoordinates" name="googleCoordinates"><br>

    <label for="availableArea">Total Available Area (Approx sq. ft):</label>
    <input type="text" id="availableArea" name="availableArea"  required><br>

    <h3>DETAILED SKETCH</h3>
    <label for="parapet">Parapet Railing Wall Height and Width:</label>
    <input type="text" id="parapet" name="parapet"  required><br>

    <label for="roofType">Roof Type:</label>
    <select id="roofType" name="roofType" required>
      <option value="rcc">RCC</option>
      <option value="tin_shed">Tin Shed</option>
      <option value="ground">Ground</option>
      <option value="both">Both</option>
    </select><br>

    <label for="floors">No of Floors & Height:</label>
    <input type="text" id="floors" name="floors"  required><br>

    <label for="dcCable">DC Cable Size (sq mm) & Length (ft):</label>
    <input type="text" id="dcCable" name="dcCable" required><br>

    <label for="acCableType">AC Cable Type:</label>
    <select id="acCableType" name="acCableType"  required>
      <option value="aluminium">Aluminium</option>
      <option value="copper">Copper</option>
    </select><br>

    <label for="acCableSize">AC Cable Size (sq mm) & Length (ft):</label>
    <input type="text" id="acCableSize" name="acCableSize"  required><br>

    <label for="earthingCableType">Earthing Cable Type:</label>
    <select id="earthingCableType" name="earthingCableType"  required>
      <option value="aluminium">Aluminium</option>
      <option value="copper">Copper</option>
    </select><br>

    <label for="earthingCableSize">Earthing Cable Size (sq mm) & Length (ft):</label>
    <input type="text" id="earthingCableSize" name="earthingCableSize"  required><br>

    <label for="treeHeight">Specify Tree, Tower Height:</label>
    <input type="text" id="treeHeight" name="treeHeight"  required><br>

    <label for="earthPit">Number of Spare Earth Pit and Location:</label>
    <input type="text" id="earthPit" name="earthPit"  required><br>

    <label for="laHeight">LA, Height:</label>
    <input type="text" id="laHeight" name="laHeight"  required><br>
  </div>

  <!-- Option 1: ELECTRICAL ASPECT for ON GRID/OFF GRID -->
  <div id="electricalAspects" style="display: none;">
    <h3>ELECTRICAL ASPECT</h3>
    <label for="connectionType">Type of Connection:</label>
    <select id="connectionType" name="connectionType"   required>
      <option value="single">Single Phase</option>
      <option value="three">Three Phase</option>
      <option value="no_grid">No Grid</option>
    </select><br>

    <label for="discom">DISCOM:</label>
    <input type="text" id="discom" name="discom" required><br>

    <label for="meteringPoints">Total No of Metering Points:</label>
    <input type="text" id="meteringPoints" name="meteringPoints" required><br>

    <label for="ltPanel">LT Panel and ACDB Wire Size & Length:</label>
    <input type="text" id="ltPanel" name="ltPanel" required><br>

    <label for="inverterWire">ACDB and Inverter Wire Size & Length:</label>
    <input type="text" id="inverterWire" name="inverterWire" required><br>

    <label for="acdbRating">No of ACDB with Rating:</label>
    <input type="text" id="acdbRating" name="acdbRating" required><br>

    <label for="dcdbRating">No of DCDB with Rating:</label>
    <input type="text" id="dcdbRating" name="dcdbRating" required><br>

    <label for="inverter">No of Inverter with Make & Rating:</label>
    <input type="text" id="inverter" name="inverter" required><br>

    <label for="modules">No of Module with Make & Rating:</label>
    <input type="text" id="modules" name="modules" required><br>

    <label for="siteSurvey">Site Survey Done By:</label>
    <input type="text" id="siteSurvey" name="siteSurvey" required><br>

    <label for="checkedBy">Checked By:</label>
    <input type="text" id="checkedBy" name="checkedBy" required><br>

    <label for="preparedBy">Prepared By:</label>
    <input type="text" id="preparedBy" name="preparedBy" required><br>

    <label for="date">Date:</label>
    <input type="date" id="date" name="date" required><br>
    
    
  </div>

  <!-- Option 2: Quotation and Subsidy Details for ON GRID -->
  <div id="quotationSubsidy" style="display: none;" required>
    <h3>QUOTATION AND SUBSIDY DETAILS</h3>
    <label for="plantCost">SPV Plant Cost:</label>
    <input type="text" id="plantCost" name="plantCost" required><br>

    <label for="subsidyCentral">Subsidy Central Govt:</label>
    <input type="text" id="subsidyCentral" name="subsidyCentral" required><br>

    <label for="subsidyState">Subsidy State Govt:</label>
    <input type="text" id="subsidyState" name="subsidyState" required><br>

<!--     <h4>Client Details</h4>
    <label for="clientName">Client Name:</label>
    <input type="text" id="clientName" name="clientName"><br>

    <label for="clientContact">Client Contact Details:</label>
    <input type="text" id="clientContact" name="clientContact"><br>

    <label for="mobile">Mobile No:</label>
    <input type="text" id="mobile" name="mobile"><br>

    <label for="email">Email Id:</label>
    <input type="email" id="email" name="email"><br> -->
  </div><!-- Option 3: Quotation and Subsidy Details for Solar Pump -->
<div id="option3" style="display: none;">
    <h3>Electrical Aspect</h3>
    
    <label for="connectionType">Type of Connection:</label>
    <select id="connectionType" name="connectionType" required>
        <option value="single">Single Phase</option>
        <option value="three">Three Phase</option>
        <option value="no_grid">No Grid</option>
    </select><br>

    <label for="discom">DISCOM:</label>
    <input type="text" id="discom" name="discom" required><br>

    <label for="gridVoltage">Grid Voltage & Amp:</label>
    <input type="text" id="gridVoltage" name="gridVoltage" required><br>

    <label for="motors">No of Motors, Rating & Make:</label>
    <input type="text" id="motors" name="motors" required><br>

    <label for="motorVoltage">Motor Amp & Voltage:</label>
    <input type="text" id="motorVoltage" name="motorVoltage" required><br>

    <label for="ltPanel">LT Panel and ACDB Wire Size & Length:</label>
    <input type="text" id="ltPanel" name="ltPanel" required><br>

    <label for="acdbWire">ACDB and VFD Wire Size & Length:</label>
    <input type="text" id="acdbWire" name="acdbWire" required><br>

    <label for="numAcdb">No of ACDB with Rating:</label>
    <input type="text" id="numAcdb" name="numAcdb" required><br>

    <label for="numDcdb">No of DCDB with Rating:</label>
    <input type="text" id="numDcdb" name="numDcdb" required><br>

    <label for="numVfd">No of VFD with Make & Rating:</label>
    <input type="text" id="numVfd" name="numVfd" required><br>

    <label for="numModules">No of Modules with Make & Rating:</label>
    <input type="text" id="numModules" name="numModules" required><br>

    <label for="siteSurvey">Site Survey Done By:</label>
    <input type="text" id="siteSurvey" name="siteSurvey" required><br>

    <label for="checkedBy">Checked By:</label>
    <input type="text" id="checkedBy" name="checkedBy" required><br>

    <label for="preparedBy">Prepared By:</label>
    <input type="text" id="preparedBy" name="preparedBy" required><br>

    <label for="date">Date:</label>
    <input type="date" id="date" name="date" required><br>
    
<!--     <h4>Client Details</h4>
    <label for="clientName">Client Name:</label>
    <input type="text" id="clientName" name="clientName"><br>

    <label for="clientContact">Client Contact Details:</label>
    <input type="text" id="clientContact" name="clientContact"><br>

    <label for="mobileNo">Mobile No:</label>
    <input type="text" id="mobileNo" name="mobileNo"><br>

    <label for="emailId">Email Id:</label>
    <input type="email" id="emailId" name="emailId"><br> -->
</div>


<!-- Option 4: Quotation and Subsidy Details for Existing Plant -->
<div id="option4" style="display: none;">
    <h3>Quotation and Subsidy Details</h3>

    <label for="spvPlantCost">SPV Plant Cost:</label>
    <input type="text" id="spvPlantCost" name="spvPlantCost" required><br>

    <label for="remarks">Remarks:</label>
    <textarea id="remarks" name="remarks" rows="4" cols="50" required></textarea><br>

    
</div>
<div class="client-details">
  <h3>Client Details</h3>
    
    <label for="clientName">Client Name:</label>
    <input type="text" id="clientName" name="clientName" required><br>

<!--     <label for="clientContact">Client Contact Details:</label>
    <input type="text" id="clientContact" name="clientContact" required><br> -->

    <label for="mobile">Mobile No:</label>
<input type="tel" name="mobile" id="mobile" placeholder="Enter your mobile number" maxlength="10" pattern="[0-9]{10}" required oninput="this.value = this.value.replace(/[^0-9]/g, '')">


    <label for="emailId">Email Id:</label>
    <input type="email" id="emailId" name="emailId" required><br>
</div>
  <!-- Submit Button -->
  <button type="submit">Submit</button>
  <button type="button" onclick="generatePDF()">Print to PDF</button>

</form>
   <center>
   <div class="card">
    <img src="https://newpious.com/wp-content/uploads/2023/04/logo_211__1_-removebg-preview-1.png" alt="Newpious Logo" class="logo">
    <h2>Contact Us</h2>
    <p class="description">For over 20 years, we have been a trusted provider of Solar System/Services in India. Our expert team delivers sustainable and affordable solutions customized to your needs, earning us a reputation for excellence in the industry. Let us help you harness the power of solar energy today for a greener tomorrow.</p>
    <div class="contact-details">
        <p><i class="fas fa-map-marker-alt"></i> <strong>Address:</strong> D2/541, Vikalp Khand, Gomti Nagar, Lucknow, Uttar Pradesh 226010</p>
        <iframe src="https://www.google.com/maps/embed?pb=!1m23!1m12!1m3!1d151842.45001418184!2d80.96986446040474!3d26.887931834467164!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!4m8!3e6!4m0!4m5!1s0x399c395732bec399%3A0x5d575353c6237e6a!2sD2%2F541%2C%20Vikalp%20Khand%2C%20Gomti%20Nagar%2C%20Gomti%20Nager%2C%20Lucknow%2C%20Uttar%20Pradesh%20226010!3m2!1d26.8650961!2d81.03444549999999!5e0!3m2!1sen!2sin!4v1729804087624!5m2!1sen!2sin" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        <p><i class="fas fa-envelope"></i> <strong>Email:</strong> <a href="mailto:customercare@newpious.com">customercare@newpious.com</a></p>
        <p><i class="fas fa-phone"></i> <strong>Phone:</strong> <a href="tel:+915223137400">+91 522 313 7400</a></p>
        <p><strong>Website:</strong> <a href="https://newpious.com/" target="_blank" class="button" style="color: aliceblue;">Visit our website</a></p>
    </div>
</div>
  </center>

  <script>
 let selectedLabel = ""; // Variable to store the selected option label

function showFormFields() {
    console.log("showFormFields called");

    const options = [
        { value: "on_grid", label: "ON GRID" },
        { value: "off_grid", label: "OFF GRID" },
        { value: "hybrid", label: "HYBRID" },
        { value: "flour_mill", label: "Flour Mill Atta Chakki" },
        { value: "solar_pump", label: "Solar Pump" },
        { value: "existing_plant", label: "Existing Plant" },
    ];

    const optionsString = options
        .map((option, index) => `${index + 1}. ${option.label}`)
        .join("\n");

    const userChoice = prompt(`Please select an option:\n${optionsString}  \n Enter number between 1 to 6`);
    const selectedIndex = parseInt(userChoice) - 1; // Subtract 1 to match array index

    // Check if the user selected a valid option
    if (selectedIndex >= 0 && selectedIndex < options.length) {
        const systemType = options[selectedIndex].value;
        selectedLabel = options[selectedIndex].label; // Store the label of the selected option
        
        // Update the displayed system type
        document.getElementById("selectedSystemType").innerText = selectedLabel;
        
        // Show general questions for all
        document.getElementById("generalQuestions").style.display = "block";

        // Hide all specific forms by default
        document.getElementById("electricalAspects").style.display = "none";
        document.getElementById("quotationSubsidy").style.display = "none";
        document.getElementById("option3").style.display = "none"; // For Solar Pump
        document.getElementById("option4").style.display = "none"; // For Existing Plant

        // Conditional logic based on system type
        if (systemType === "on_grid" || systemType === "off_grid" || systemType === "hybrid") {
            document.getElementById("electricalAspects").style.display = "block";
        }

        if (systemType === "on_grid") {
            document.getElementById("quotationSubsidy").style.display = "block";
        }

        if (systemType === "solar_pump" || systemType === "flour_mill" || systemType === "existing_plant") {
            document.getElementById("option3").style.display = "block";
        }

        if (systemType !== "on_grid" && systemType !== "") {
            document.getElementById("option4").style.display = "block";
        }
    } else {
        // Handle invalid input
        alert("Invalid selection. Please try again.");
    }
}

// Call showFormFields on page load to set the initial state
window.onload = function() {
    showFormFields();
};


</script>  

 
<script>
  function generatePDF() {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();
      const pageWidth = pdf.internal.pageSize.width;
const textWidth = pdf.getTextWidth(`Type of System: ${selectedLabel}`);
const xPos = (pageWidth - textWidth) / 2; // 
      const logoImg = new Image();
      logoImg.src = 'logo.png';
      const ContactIMG = new Image();
      ContactIMG.src = 'CONTACT.png';
  
      logoImg.onload = function () {
          // Add logo to the PDF
         pdf.addImage(logoImg, 'WEBP', xPos, 10, 40, 20);

// Set the main title for the PDF
pdf.setFontSize(16);
pdf.setTextColor(0, 0, 255);
pdf.setFont("helvetica", "bold");

// Add system type subheading
pdf.setFontSize(12);
pdf.setTextColor(0, 0, 0);
// Calculate the X position for centering the text
// Center the text

// Set font and text color
pdf.setFontSize(12);
pdf.setTextColor(0, 0, 0); // Black for the text

// Add the centered text
pdf.text(`Type of System: ${selectedLabel}`, xPos, 35);


// Draw a horizontal line below the title
pdf.setLineWidth(0.5);
pdf.line(10, 40, 200, 40);  // Adjust coordinates for the line as needed
  
          // Collect form data
          const formFields = document.querySelectorAll("#dynamicForm input, #dynamicForm select, #dynamicForm textarea");
          let yOffset = 45; // Y offset for content positioning
          const leftX = 10; // X position for labels
          const rightX = 100; // X position for values
          const labelValueSpacing = 50; // Adjust spacing between label and value
          let counter = 1;
  
          formFields.forEach((field) => {
              const label = document.querySelector(`label[for="${field.id}"]`);
              const labelText = label ? label.innerText : field.name;
              const value = field.value || "N/A";
  
              if (value !== "N/A") {
                  // Check if we need to break the page
                  if (yOffset > pdf.internal.pageSize.height - 40) {
                      pdf.addPage(); // Add a new page
                      yOffset = 10; // Reset Y offset for the new page
                  }
  
                  // Numbered label with minimal spacing
                  pdf.setTextColor(0, 0, 0); // Black for labels
                  pdf.setFontSize(6);
                  const fullLabel = `${counter}. ${labelText}:`;
                  const labelTextLines = pdf.splitTextToSize(fullLabel, labelValueSpacing);
  
                  pdf.text(labelTextLines, leftX, yOffset);
  
                  // Value text, wrapping if necessary
                  pdf.setTextColor(0, 128, 0); // Green for values
                  const valueLines = pdf.splitTextToSize(value, 80);
                  pdf.text(valueLines, rightX, yOffset);
  
                  // Update counters and Y offset
                  counter++;
                  const lineSpacing = Math.max(labelTextLines.length, valueLines.length) * 6;
                  yOffset += lineSpacing; // Increment Y offset based on content
              }
          });
  
          // Position Contact image at the bottom, with minimal spacing
  
          // Check if Contact image fits on the current page, else add a new page
         
  
          // Save the PDF
          pdf.save("Filled_Form_Newpious_Synergies.pdf");
      };
  }
  </script>
  
  





  
  





  
  
  </body>
</html>
